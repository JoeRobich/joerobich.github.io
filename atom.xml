<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Joey Robichaud]]></title>
  <link href="http://www.joeyrobichaud.com/atom.xml" rel="self"/>
  <link href="http://www.joeyrobichaud.com/"/>
  <updated>2014-06-02T08:40:04-04:00</updated>
  <id>http://www.joeyrobichaud.com/</id>
  <author>
    <name><![CDATA[Joey Robichaud]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[The Story of asfac]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2013/01/28/the-story-of-asfac/"/>
    <updated>2013-01-28T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2013/01/28/the-story-of-asfac</id>
    <content type="html"><![CDATA[<p>Asfac is a simple IoC container for ActionScript and this is the story of how it came into being.</p>

<h3>Genesis</h3>

<p>It is all <a href="http://stackoverflow.com/users/22656/jon-skeet">Jon Skeet</a>&rsquo;s fault really. I rediscovered this gem of a video he recorded with <a href="http://wekeroad.com/">Rob Conery</a> for a series on <a href="http://tekpub.com/" target="_blank">TekPub</a>. In the video Jon creates a functioning IoC container in matter of minutes.</p>

<div class="embed-video-container"><iframe src="http://www.youtube.com/embed/cfvTfU5RK8Q "></iframe></div>


<p>I was unfamiliar with the concept of containers at the time, but the basics looked simple enough. So I set out to learn more by implementing a container for ActionScript. Why ActionScript you might ask? I wanted to explore the concepts without directly copying Jon&rsquo;s code. My first stab at the container lives as a <a href="https://gist.github.com/3719764">gist</a> and is a pretty straight port of Jon&rsquo;s code. A good start perhaps, but I wanted better.</p>

<h3>Work in Progress</h3>

<p>Asfac represents my first project written with a TDD approach and an excuse to try out new development processes. After getting Dave on board, we paired going back and forth one writing a failing test; the other writing the code that would make it pass. This went on for a while until we had gotten the equivalent of Jon&rsquo;s container working in ActionScript. I was excited. Not only did TDD keep me very focused on individual requirements but pairing was great for keeping me on task.</p>

<p>With a functional container written, Dave wanted to see how far we could push it. He had already been using containers in his .NET work and wanted to bring some sugar over. So we started making our wish list of functionality; things like a fluent interface, scoped registration, and property injection.</p>

<p>We then entered all this information into GitHub. We took advantage of the issue tracking for logging bugs and enhancements, worked in feature branches during development, and issued pull requests for the other to code review. Basically what I consider to be a healthy development process.</p>

<h3>Stick in the Mud</h3>

<p>With development of all the functionality wrapping up there was only one task left to accomplish, Documentation. We knew that asfac certainly didn&rsquo;t need a book to use, but it did need to be documented. Dave opened an issue and created a branch. He reorganized the sample code in the read-me this time with better descriptions. We started reviewing the API documentation in the AsDoc comments and then it all stopped. Months passed with a releasable version of asfac sitting around waiting to be documented.</p>

<p>The new year has a way of stirring some self reflection. Over the winter break I started making a mental list of where I could improve over the next year. One area that seems to be on every year&rsquo;s list is &lsquo;finishing&rsquo;. Why wait another year to see if I could get better at it? Start finishing now!</p>

<p>I cloned the asfac repository and gave it a proper review. I standardized things like comments being in sentence structure not as fragments, fixed variable names that had long since changed in the code, and pushed it all up to GitHub for a final look over. It only took a week to sync up with Dave and get it all merged into master.</p>

<h3>Wrap up</h3>

<p>So it took a while but we are at v1.0. We finished something we started. Success! So if you are using ActionScript and have need of an IoC container, then please take us into consideration with all the others and let us know how we stack up.</p>

<p><a href="https://github.com/thedevstop/asfac">asfac on GitHub</a></p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2013/01/28/the-story-of-asfac/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[From JavaScriptSerializer to JSON.Net]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2012/04/09/from-javascriptserializer-to-jsonnet/"/>
    <updated>2012-04-09T00:00:00-04:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2012/04/09/from-javascriptserializer-to-jsonnet</id>
    <content type="html"><![CDATA[<p>Recently I was in charge of replacing the JSON serializers being used in an existing project to squeeze out a little better performance. I looked at a couple libraries for .Net and settled on the almost ubiquitous <a href="http://json.codeplex.com/" title="JSON.Net">JSON.Net</a>. This decision felt even more right after it was announced that JSON.Net will become the default serializer for ASP.Net.</p>

<p>A few thoughts were guiding me in this process:
&ndash; I am not intimately familiar with JSON.Net
&ndash; I didn&rsquo;t have a lot of time to become familiar with it
&ndash; I had lots of code in the project that used the serializer directly
&ndash; I need to port several JavaScriptConverters over to equivalent JSON.Net JsonConverters</p>

<p>With this in mind, I choose to abstract out the differences instead of attempt a wholesale rewrite. The first task was to create a set of interfaces that roughly resembled the JavaScriptSerializer and JavaScriptConverter classes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="mi">IJsonSerializer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">void</span> <span class="nf">RegisterConverters</span><span class="p">(</span><span class="mi">IEnumerable</span><span class="p">&lt;</span><span class="mi">IJsonConverter</span><span class="p">&gt;</span> <span class="nv">converters</span><span class="p">);</span>
</span><span class='line'>    <span class="n">T</span> <span class="nf">ConvertToType</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nv">dictionary</span><span class="p">);</span>
</span><span class='line'>    <span class="n">T</span> <span class="nf">Deserialize</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">input</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">string</span> <span class="nf">Serialize</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">string</span> <span class="nf">DefaultSerialize</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="mi">IJsonConverter</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">object</span> <span class="nf">Deserialize</span><span class="p">(</span><span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nv">dictionary</span><span class="p">,</span> <span class="nc">Type</span> <span class="nv">type</span><span class="p">,</span> <span class="mi">IJsonSerializer</span> <span class="nv">serializer</span><span class="p">);</span>
</span><span class='line'>    <span class="nv">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">Serialize</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">,</span> <span class="mi">IJsonSerializer</span> <span class="nv">serializer</span><span class="p">);</span>
</span><span class='line'>    <span class="nv">IEnumerable</span><span class="p">&lt;</span><span class="nc">Type</span><span class="p">&gt;</span> <span class="n">SupportedTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, I made a JSON.Net JsonConverter that will wrap my existing converter classes that now implement IJsonConverter. It handles serializing and deserializing into a Dictionary before passing off to the legacy JavaScriptSerializer code.</p>

<p>Since I needed to get up and running fast, I borrowed the ExpandoObjectConverter class from JSON.Net and tweaked it to build out a Dictionary instead. I could then invoke the IJsonConverter class to take the serialization the rest of the way.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">NewtonsoftJsonConverter</span> <span class="p">:</span> <span class="nc">JsonConverter</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="mi">IJsonConverter</span> <span class="nv">_converter</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'>    <span class="k">private</span> <span class="mi">IJsonSerializer</span> <span class="nv">_serializer</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">NewtonsoftJsonConverter</span><span class="p">(</span><span class="mi">IJsonSerializer</span> <span class="nv">serializer</span><span class="p">,</span> <span class="mi">IJsonConverter</span> <span class="nv">converter</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">_serializer</span> <span class="p">=</span> <span class="n">serializer</span><span class="p">;</span>
</span><span class='line'>        <span class="n">_converter</span> <span class="p">=</span> <span class="n">converter</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">CanConvert</span><span class="p">(</span><span class="nc">Type</span> <span class="nv">objectType</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">foreach</span> <span class="p">(</span><span class="nc">Type</span> <span class="nv">type</span> <span class="k">in</span> <span class="n">_converter</span><span class="p">.</span><span class="n">SupportedTypes</span><span class="p">)</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsAssignableFrom</span><span class="p">(</span><span class="n">objectType</span><span class="p">))</span>
</span><span class='line'>                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="kt">object</span> <span class="nf">ReadJson</span><span class="p">(</span><span class="nc">JsonReader</span> <span class="nv">reader</span><span class="p">,</span> <span class="nc">Type</span> <span class="nv">objectType</span><span class="p">,</span> <span class="kt">object</span> <span class="n">existingValue</span><span class="p">,</span> <span class="nc">JsonSerializer</span> <span class="nv">serializer</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">object</span> <span class="nv">value</span> <span class="p">=</span> <span class="n">ReadValue</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(!(</span><span class="n">value</span> <span class="k">is</span> <span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;))</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Expected dictionary but found a list&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">value</span> <span class="p">=</span> <span class="n">_converter</span><span class="p">.</span><span class="n">Deserialize</span><span class="p">((</span><span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;)</span><span class="n">value</span><span class="p">,</span> <span class="n">objectType</span><span class="p">,</span> <span class="n">_serializer</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="kt">object</span> <span class="nf">ReadValue</span><span class="p">(</span><span class="nc">JsonReader</span> <span class="nv">reader</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span> <span class="p">==</span> <span class="n">JsonToken</span><span class="p">.</span><span class="n">Comment</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(!</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Unexpected end.&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">switch</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">StartObject</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">ReadObject</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">StartArray</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="nf">ReadList</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>            <span class="k">default</span><span class="p">:</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">IsPrimitiveToken</span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span><span class="p">))</span>
</span><span class='line'>                    <span class="k">return</span> <span class="n">reader</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;Unexpected token when converting to Dictionary: {0}&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">IsPrimitiveToken</span><span class="p">(</span><span class="nc">JsonToken</span> <span class="nv">token</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">switch</span> <span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Integer</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Float</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">String</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Boolean</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Undefined</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Null</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Date</span><span class="p">:</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Bytes</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>            <span class="k">default</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="kt">object</span> <span class="nf">ReadList</span><span class="p">(</span><span class="nc">JsonReader</span> <span class="nv">reader</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="mi">IList</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="nv">list</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">switch</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Comment</span><span class="p">:</span>
</span><span class='line'>                    <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                <span class="k">default</span><span class="p">:</span>
</span><span class='line'>                    <span class="kt">object</span> <span class="nv">v</span> <span class="p">=</span> <span class="n">ReadValue</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                    <span class="n">list</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span><span class='line'>                    <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">EndArray</span><span class="p">:</span>
</span><span class='line'>                    <span class="k">return</span> <span class="n">list</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Unexpected end.&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="kt">object</span> <span class="nf">ReadObject</span><span class="p">(</span><span class="nc">JsonReader</span> <span class="nv">reader</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nv">dictionary</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">switch</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">TokenType</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">PropertyName</span><span class="p">:</span>
</span><span class='line'>                    <span class="kt">string</span> <span class="nv">propertyName</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(!</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Unexpected end.&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                    <span class="kt">object</span> <span class="nv">v</span> <span class="p">=</span> <span class="n">ReadValue</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                    <span class="n">dictionary</span><span class="p">[</span><span class="n">propertyName</span><span class="p">]</span> <span class="p">=</span> <span class="n">v</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">Comment</span><span class="p">:</span>
</span><span class='line'>                    <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                <span class="k">case</span> <span class="nc">JsonToken</span><span class="p">.</span><span class="nv">EndObject</span><span class="p">:</span>
</span><span class='line'>                    <span class="k">return</span> <span class="n">dictionary</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Unexpected end.&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">WriteJson</span><span class="p">(</span><span class="nc">JsonWriter</span> <span class="nv">writer</span><span class="p">,</span> <span class="kt">object</span> <span class="n">value</span><span class="p">,</span> <span class="nc">JsonSerializer</span> <span class="nv">serializer</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nv">dictionary</span> <span class="p">=</span> <span class="n">_converter</span><span class="p">.</span><span class="n">Serialize</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_serializer</span><span class="p">);</span>
</span><span class='line'>        <span class="n">serializer</span><span class="p">.</span><span class="n">Serialize</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lastly, I needed to wrap the JSON.Net serializer within my IJsonSerializer interface so that my existing code can get all the benefit of its performance with little changes in my code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">NewtonsoftJsonSerializer</span> <span class="p">:</span> <span class="mi">IJsonSerializer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="nc">JsonSerializerSettings</span> <span class="nv">_settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">JsonSerializerSettings</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">RegisterConverters</span><span class="p">(</span><span class="mi">IEnumerable</span><span class="p">&lt;</span><span class="mi">IJsonConverter</span><span class="p">&gt;</span> <span class="nv">converters</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">foreach</span> <span class="p">(</span><span class="mi">IJsonConverter</span> <span class="nv">converter</span> <span class="k">in</span> <span class="n">converters</span><span class="p">)</span>
</span><span class='line'>            <span class="n">_settings</span><span class="p">.</span><span class="n">Converters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="nc">NewtonsoftJsonConverter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">converter</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">T</span> <span class="nf">ConvertToType</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="mi">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nv">dictionary</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">string</span> <span class="nv">intermediate</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="n">dictionary</span><span class="p">);</span>
</span><span class='line'>        <span class="nc">T</span> <span class="nv">value</span> <span class="p">=</span> <span class="nv">JsonConvert.DeserializeObject</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="n">intermediate</span><span class="p">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">T</span> <span class="nf">Deserialize</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">input</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nc">JsonConvert</span><span class="p">.</span><span class="nv">DeserializeObject</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="n">input</span><span class="p">,</span> <span class="n">_settings</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="nf">Serialize</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nc">JsonConvert</span><span class="p">.</span><span class="nv">SerializeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Formatting</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="n">_settings</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="nf">DefaultSerialize</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nc">JsonConvert</span><span class="p">.</span><span class="nv">SerializeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>After changing a few import statements I was ready to go. Testing showed a particular server query that had been taking close to 2 minutes to return would now return in under 30 seconds consistently. This was certainly a huge win considering it required a very small set of changes to the project&rsquo;s code.</p>

<p>Overall the process went smoothly and I am very happy with the result. If you would like to use this code yourself, it is available as a <a href="https://gist.github.com/2331300">Gist on GitHub</a>.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2012/04/09/from-javascriptserializer-to-jsonnet/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Making a Code Library]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2012/02/03/making-a-code-library/"/>
    <updated>2012-02-03T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2012/02/03/making-a-code-library</id>
    <content type="html"><![CDATA[<p>Probably not the kind of library you were expecting, but one that I find to be pretty handy.</p>

<h2>Windows Libraries</h2>

<p>A new feature in the much derided Windows Vista was the ability to group folders of like content into libraries. Vista and Windows 7 come pre-loaded with Documents, Music, Picture, and Video libraries. Today we are going to step through making a Source library.</p>

<p>If you are anything like me and I suspect a number of you are then, you have code scattered all across your hard drive. You could move all that source into one folder under Documents and be done with it. However, there are times when you just cannot move the source. Creating a library is a way of managing the clutter.</p>

<h3>Create the library</h3>

<p>First, let us press Windows + E to open Explorer. Right-click the Libraries folder. Go to New, then click on &lsquo;Library&rsquo;.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/new-library.png" alt="New library" /></p>

<p>Let&rsquo;s name it Source..</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/source-library.png" alt="The source library" /></p>

<p>Click on it. As you can see there is not that not much going on yet.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/empty-source-library.png" alt="Empty source library" /></p>

<h3>Including your source folders</h3>

<p>Now we will go through and add all the source folders from your hard drive.</p>

<p>Right click the Source library and click on &lsquo;Properties&rsquo;.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/include-a-folder1.png" alt="Source library properties" /></p>

<p>Click on &lsquo;Include a folder&hellip;&rsquo; and start adding all your source folders.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/include-a-folder2.png" alt="Include a folder" /></p>

<p>After adding my various code cubbyholes my properties looks like this..</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/all-folders-added2.png" alt="All folders added" /></p>

<p>Note that by default the first folder added becomes the &lsquo;save location&rsquo;. This is the folder that files are stored in when the Source Library folder is selected. If you want to change the default select the folder you want to become the save location then, click the &lsquo;Set save location&rsquo; button.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/set-save-folder2.png" alt="Set save folder" /></p>

<h3>Clean house accomplished!</h3>

<p>Yay! Everything is all in one place now. Too bad Windows doesn&rsquo;t detect included folders with the save name and display more of the path.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/source-library-complete.png" alt="Source library complete" /></p>

<p>I hope you found this useful or at least stopped reading before I wasted too much of your time. =p</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2012/02/03/making-a-code-library/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Consolas for github]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2012/01/27/consolas-for-github/"/>
    <updated>2012-01-27T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2012/01/27/consolas-for-github</id>
    <content type="html"><![CDATA[<p>I was reading my twitter feed the other day and saw this exchange come through&hellip;</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/why-not-consolas.png" alt="Why not Consolas?" /></p>

<p>and I couldn&rsquo;t agree more. So I decided to do something about it!</p>

<h2>Getting to know Greasemonkey</h2>

<p>I remember hearing about Greasemonkey scripts back in Firefox&rsquo;s heyday. According to Wikipedia, <a href="http://en.wikipedia.org/wiki/Greasemonkey">Greasemonkey</a> &ldquo;&hellip; allows users to install scripts that make on-the-fly changes to HTML web page content &hellip;&rdquo; Even better than that, Google Chrome treats the scripts as extensions <a href="http://www.chromium.org/developers/design-documents/user-scripts">right out of the box</a>.</p>

<p>Of course, I have never written a Greasemonkey script so, I went to the worlds repository of these scripts, <a href="http://userscripts.org/">Userscripts.org</a>. Right off the bat, Userscripts made it super easy to get my bearings; they allow you to view the source of existing scripts right in the browser.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/userscripts-source-code1.png" alt="Userscripts view source code" /></p>

<p>My next stop is over at github to figure out what CSS I need to replace.</p>

<h2>Github&rsquo;s CSS</h2>

<p>Alright, time to use those F12 tools! I browsed over to the <a href="https://github.com/mono/monodevelop">MonoDevelop</a> project on github and inspected the element that contained source code.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/pre-font-family-css.png" alt="Source code font family css" /></p>

<p>Great! Now I know the CSS selectors that I need to override. With this knowledge in hand I started my first user script.</p>

<p>First, I borrowed a bit of code for injecting a new style elements into the page head. I then copied the CSS for github&rsquo;s pre element over to my script and added Consolas to the beginning of the font family definition. Just like that, I had the first version of my script.</p>

<h2>Bringing it together</h2>

<p>I created an account on Userscripts.org and navigated to script management. Uploading was as simple as pointing to my script file and filling out some metadata about the script. Time to see it in action!</p>

<h2>The finish line!</h2>

<p>I went to the <a href="http://userscripts.org/scripts/show/123936">Consolas for github</a> script page with Chrome and clicked the install button.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/userscripts-install.png" alt="Userscripts install" /></p>

<p>Followed the prompts..</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/userscripts-continue.png" alt="Continue installation" />
<img src="http://thedevstop.files.wordpress.com/2012/01/userscripts-add.png" alt="Add script as extension" /></p>

<p>.. and Success!</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/before-and-after.png" alt="Code before and after" /></p>

<p>After some twiddling, I get the in-browser editor using Consolas as well.</p>

<p>Install it. Enjoy it. Remix it. Please just don&rsquo;t make Comic Sans for github.</p>

<p><a href="http://userscripts.org/scripts/show/123936">Consolas for github on Userscripts.org</a></p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2012/01/27/consolas-for-github/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VibrantInk Theme for FlashDevelop]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2012/01/04/vibrantink-theme-for-flashdevelop/"/>
    <updated>2012-01-04T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2012/01/04/vibrantink-theme-for-flashdevelop</id>
    <content type="html"><![CDATA[<p>At work consummate developer <a href="http://joshuarogers.net/">Josh Rogers</a> got <a href="http://www.flashdevelop.org/">FlashDevelop</a> working with a custom ant build script as a replacement for FlashBuilder. This is great news because FlashDevelop is using less than a tenth of the memory resources that Adobe&rsquo;s Eclipse-based FlashBuilder uses; You should check it out if you are in Flex-land like me.</p>

<p>Now since the first thing I do whenever I start using a new IDE is move over my favorite syntax colors (see also <a href="http://thedevstop.wordpress.com/2011/08/17/vibrantink-theme-for-flashbuilder/">VibrantInk for FlashBuilder</a> and <a href="http://thedevstop.wordpress.com/2011/08/29/vibrantink-theme-for-notepad/">VibrantInk for Notepad++</a>), I am once again giving you the fruits of my labor.</p>

<p><img src="http://thedevstop.files.wordpress.com/2012/01/vibrantink-flashdevelop.png" alt="VibrantInk FlashDevelop" /></p>

<p>It&rsquo;s glorious and it is all yours, if you click <a href="http://goo.gl/8RMmO">here</a>!</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2012/01/04/vibrantink-theme-for-flashdevelop/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VibrantInk Theme for Notepad++]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/08/29/vibrantink-theme-for-notepadplusplus/"/>
    <updated>2011-08-29T00:00:00-04:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/08/29/vibrantink-theme-for-notepadplusplus</id>
    <content type="html"><![CDATA[<p>Let me start by saying that I know notepad++ comes with a Vibrant Ink theme. It is likely much, much more accurate and if you love TextMate for Mac you should probably use it. However, this theme is based on the <a href="http://thedevstop.wordpress.com/2011/08/17/vibrantink-theme-for-flashbuilder/">VibrantInk theme for FlashBuilder</a> and thusly on the <a href="http://blog.wekeroad.com/2007/10/17/textmate-theme-for-visual-studio-take-2/">Visual Studio theme</a> that inspired it.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/notepadpp.png" alt="Notepad++" /></p>

<p>To install simple copy the VInk.xml into %PROGRAMFILES%\Notepad++\themes and restart notepad if it is open. You can change your theme from the Settings > Style Configurator&hellip; dialog.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/settings-menu.png" alt="Settings menu" /></p>

<p>Where it says Select Theme, simply choose VInk.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/configurator.png" alt="Style Configuration Dialog" /></p>

<p>I have loaded sample code from several languages with it and am satisfied I caught the spirit of the theme. If you want you can download it <a href="https://docs.google.com/leaf?id=0B2UumFXyeY3BZDQwYzhkMTItZDY2Ny00NGMwLWFmMzQtOTQ1ODkwNjc5OTcw&amp;amp;hl=en_US">here</a>.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/08/29/vibrantink-theme-for-notepad/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Started with Manatee and SQL Server CE]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/08/24/getting-started-with-manatee-and-sql-server-ce/"/>
    <updated>2011-08-24T00:00:00-04:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/08/24/getting-started-with-manatee-and-sql-server-ce</id>
    <content type="html"><![CDATA[<p>I am new to the concept of migrations but am really liking the whole concept.</p>

<blockquote><p>&ldquo;Migrations represent a &#8220;non-violent&rdquo; way, basically, to transition the schema of your database as your app grows.&ldquo; &ndash; Rob Conery from &rdquo;<a href="http://wekeroad.com/post/4826459948/musing-on-simpler-migrations">Musing on Simpler Migrations</a>&#8221;</p></blockquote>

<p>Having seen the way a schema grows after several releases of a product it can be a lot to manage. Traditionally, I have kept a folder of scripts for a clean install and a folder of scripts for upgrading from previous versions. However this approach requires testing and verification that there is rarely time to perform in the environment that I currently find myself. Did I mention that we also have to keep all the scripts in an Oracle and SQL Server flavor? Egad!</p>

<p>After fighting with this for a few years, it was time to take a step back and evaluate my options. Two things happened that helped me forge a new path. The first is that I came across Rob Conery&rsquo;s <a href="http://wekeroad.com/">blog</a> and in particular the <a href="https://github.com/robconery/Manatee">Manatee tool</a> that he has written. Rob has been bringing the best of what the Ruby world has to offer to .Net developers as part of his TekPub series &ldquo;<a href="http://tekpub.com/view/webmatrix/1">Hacking WebMatrix</a>&rdquo;. The second was the <a href="http://weblogs.asp.net/scottgu/archive/2010/06/30/new-embedded-database-support-with-asp-net.aspx">announcement</a> of a new version of <a href="http://www.microsoft.com/sqlserver/en/us/editions/compact.aspx">SQL Server CE</a> that supported multi-threaded web environments. By delivering a database solution we were no longer bound to support any platform our customers happened to be using.</p>

<p>Now that we have a plan let us see how it all fits together.</p>

<h3>Using Manatee</h3>

<p>Step one is to visit GitHub and pick up the latest cut of Manatee. If you are unfamiliar with Git you can download a zipped package of the source by clicking on &lsquo;Downloads&rsquo;. Once you have pulled the repository or unzipped the source, double click Manatee.sln to open Visual Studio. Press F5 to build and you have a command line tool to manage your databases schema.</p>

<p>&ldquo;Sounds great but how do we build up the schema?&rdquo;, you ask. Enter the migrations file.</p>

<p>Manatee uses a JSON object as the medium for describing each migration. Each file contains a definition of how to move the schema up and down a version. These definitions are found in the &lsquo;up&rsquo; and &lsquo;down&rsquo; properties of the migration&rsquo;s JSON object. In simple cases, such as creating a table and adding a foreign key, the DOWN can be inferred from the UP and is not required. Each migration file contains a single change to the database. A single change being altering a field name, or adding a foreign key constraint. A migration file can also contain an execute script allowing up to insert default values into the database.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nx">up</span><span class="o">:</span><span class="p">{</span>
</span><span class='line'>        <span class="nx">create_table</span><span class="o">:</span><span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Project&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">columns</span><span class="o">:</span><span class="p">[</span>
</span><span class='line'>                <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;string&#39;</span><span class="p">},</span>
</span><span class='line'>                <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;text&#39;</span><span class="p">},</span>
</span><span class='line'>                <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Instructions&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;text&#39;</span><span class="p">},</span>
</span><span class='line'>                <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;string&#39;</span><span class="p">}</span>
</span><span class='line'>             <span class="p">],</span>
</span><span class='line'>            <span class="nx">timestamps</span><span class="o">:</span><span class="kc">true</span>
</span><span class='line'>         <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above will create a new table named Project. There is an implied primary key named Id. Since I set the timestamps flag to true, fields for tracking created and updated dates will also be created automatically.</p>

<h3>Making Manatee work with SQL Server CE</h3>

<p>I ran into a few snags when building my database with Manatee. Luckily we have the source and are free to make changes as needed.</p>

<p>One issue I ran into is that Manatee will not create a SQL Server CE database for me. I could use the SqlCE Toolbox in Visual Studio but that just seems like too much work for me.</p>

<p>The first step to fixing this is to reference the SQL Server CE assembly in the Manatee project. I fired up NuGet and it quickly got me registered.</p>

<p>Next, I added a check to the SetupConnectionAndFactory method of the Migrator.cs. It looks at the DataProvider specified in the Manatee.config to see if we are using System.Data.SqlServerCe.4.0. If it is then, we will create a new database if we are unable to verify the connection string. (I am aware that there are several problems that will cause verification to fail other than simply not existing, but this will work for us for the time being)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">SetupConnectionAndFactory</span><span class="p">(</span><span class="kt">string</span> <span class="n">connectionStringName</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">connectionStringName</span> <span class="p">==</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">connectionStringName</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">ConnectionStrings</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">Name</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">ConnectionStrings</span><span class="p">[</span><span class="n">connectionStringName</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;Can&#39;t find a connection string with the name &#39;&quot;</span> <span class="p">+</span>
</span><span class='line'>                                            <span class="n">connectionStringName</span> <span class="p">+</span> <span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nc">var</span> <span class="nv">providerName</span> <span class="p">=</span> <span class="s">&quot;System.Data.SqlClient&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nc">var</span> <span class="nv">connectionStringsSettings</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">ConnectionStrings</span><span class="p">[</span><span class="n">connectionStringName</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">connectionStringsSettings</span><span class="p">.</span><span class="n">ProviderName</span><span class="p">))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">providerName</span> <span class="p">=</span> <span class="n">connectionStringsSettings</span><span class="p">.</span><span class="n">ProviderName</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">_factory</span> <span class="p">=</span> <span class="n">DbProviderFactories</span><span class="p">.</span><span class="n">GetFactory</span><span class="p">(</span><span class="n">providerName</span><span class="p">);</span>
</span><span class='line'>    <span class="n">_connectionString</span> <span class="p">=</span> <span class="n">connectionStringsSettings</span><span class="p">.</span><span class="n">ConnectionString</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">providerName</span> <span class="p">==</span> <span class="s">&quot;System.Data.SqlServerCe.4.0&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">InitializeDatabase</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeDatabase</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nc">var</span> <span class="nv">engine</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">System.Data.SqlServerCe.SqlCeEngine</span><span class="p">(</span><span class="n">_connectionString</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(!</span><span class="n">engine</span><span class="p">.</span><span class="n">Verify</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">engine</span><span class="p">.</span><span class="n">CreateDatabase</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">engine</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>After setting this up I ran into an issue creating foreign keys. SqlCE does not support the WITH NOCHECK clause when adding the constraint. The offending code is in the GetCommand method of the Migrator class. One small edit later and now I can add constraints.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="p">...</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">string</span> <span class="nv">toColumn</span> <span class="p">=</span> <span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span><span class="p">.</span><span class="n">to_column</span> <span class="p">??</span> <span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span><span class="p">.</span><span class="n">from_column</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nc">var</span> <span class="nv">sql</span> <span class="p">=</span> <span class="s">@&quot;ALTER TABLE {1}  ADD  </span>
</span><span class='line'><span class="s">CONSTRAINT [FK_{1}_{0}] FOREIGN KEY ([{3}])</span>
</span><span class='line'><span class="s">REFERENCES {0} ([{2}]);&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">sb</span><span class="p">.</span><span class="n">AppendFormat</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span><span class="p">.</span><span class="n">from_table</span><span class="p">,</span>
</span><span class='line'>        <span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span><span class="p">.</span><span class="n">to_table</span><span class="p">,</span> <span class="n">op</span><span class="p">.</span><span class="n">foreign_key</span><span class="p">.</span><span class="n">from_column</span><span class="p">,</span> <span class="n">toColumn</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Why Run from ./Bin/Debug?</h3>

<p>It seems that Manatee is envisioned to run from bin/debug. It looks for the Migrations folder two levels up from the current directory. I can see why you might want to leave it this way, but I would prefer for the Manatee to run in the same directory as the Migrations folder.</p>

<p>We need to update the LocateMigrations method in the Program class. We will change it to use the current directory instead of the it&rsquo;s grandparent.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">static</span> <span class="kt">string</span> <span class="nf">LocateMigrations</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//this is the current directory</span>
</span><span class='line'>    <span class="nc">var</span> <span class="nv">currentDirectory</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">DirectoryInfo</span><span class="p">(</span><span class="n">Directory</span><span class="p">.</span><span class="n">GetCurrentDirectory</span><span class="p">());</span>
</span><span class='line'>    <span class="c1">//return the Migrations directory</span>
</span><span class='line'>    <span class="k">return</span> <span class="nc">Path</span><span class="p">.</span><span class="nv">Combine</span><span class="p">(</span><span class="n">currentDirectory</span><span class="p">.</span><span class="n">FullName</span><span class="p">,</span> <span class="s">&quot;Migrations&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Time to Get Started</h3>

<p>With that change I am done for now. Manatee creates SqlCE databases and foreign keys now. I still need to put it through it&rsquo;s paces, but I think I have a good start.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/08/24/getting-started-with-manatee-and-sql-server-c/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VibrantInk Theme for FlashBuilder]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/08/17/vibrantink-theme-for-flashbuilder/"/>
    <updated>2011-08-17T00:00:00-04:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/08/17/vibrantink-theme-for-flashbuilder</id>
    <content type="html"><![CDATA[<p><a href="http://thedevstop.wordpress.com/2011/08/16/add-settings-hotkeys-to-visual-studio-2010/">Yesterday</a> I mentioned that I don&rsquo;t care for Visual Studio&rsquo;s default theme color choices, that I much prefer Rob Conery&rsquo;s <a href="http://blog.wekeroad.com/2007/10/17/textmate-theme-for-visual-studio-take-2/">VibrantInk</a>. Well I don&rsquo;t care for FlashBuilder&rsquo;s defaults either. So, I give you VibrantInk for FlashBuilder 4.5.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/flashbuilder4.png" alt="flashbuilder4" /></p>

<p>Some parts of the highlighting did not port well since FB does not support semantic highlighting, but all in all it is pretty faithful. Just drop the contents of this zip file in your  {workspace}.metadata.plugins\org.eclipse.core.runtime.settings folder and restart FB if it is running.</p>

<p><a href="https://docs.google.com/viewer?a=v&amp;amp;pid=explorer&amp;amp;chrome=true&amp;amp;srcid=0B2UumFXyeY3BNjhmYjNkMWMtNThjZi00ZDQ3LWIwMzEtODU1MDZhMThkMGU0&amp;amp;hl=en_US">Download</a></p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/08/17/vibrantink-theme-for-flashbuilder/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Add Settings hotkeys to Visual Studio 2010]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/08/16/add-settings-hotkeys-to-visual-studio-2010/"/>
    <updated>2011-08-16T00:00:00-04:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/08/16/add-settings-hotkeys-to-visual-studio-2010</id>
    <content type="html"><![CDATA[<p>On several occasions I have presented topics to my team during our monthly lunch and learns. These presentations almost always include code samples and complaints about font size. Although I had read, I have never taken Scott Hanselman&rsquo;s advice for <a href="http://www.hanselman.com/blog/TheGuideToCreatingQualityTechnicalScreencasts.aspx">preparing for a screencast</a>. Most of which are applicable when presenting.</p>

<blockquote><p>&ldquo;Use the standard Visual Studio Font Colors&hellip; change your fonts to Consolas Size 15.&rdquo;</p></blockquote>

<p>Oh no! I haven&rsquo;t used the default Visual Studio theme since I ran across Rob Conery&#8217;s <a href="http://blog.wekeroad.com/2007/10/17/textmate-theme-for-visual-studio-take-2/">Vibrant Ink theme</a> (which should be shipped as the defaults IMHO). It would be nice if Visual Studio made it simple to switch between various configurations on the fly.</p>

<p>Then last week I saw <a href="http://twitter.com/#!/JeffHandley/status/101520788745756672" target="_blank">this tweet</a> come through my feed.</p>

<blockquote><p><img src="http://thedevstop.files.wordpress.com/2011/08/tweet.png" alt="Tweet" /></p></blockquote>

<p>That&rsquo;s it. I decided that today was the day for change. Jeff Handley&rsquo;s macros make it dead simple to go from development to presentation mode on the fly.</p>

<p>There are just a few things that I wanted to tweak. First, I found switching to presentation mode took too long, and I thought it would be simpler to just change the font size. Second, I wanted to be able to switch between the default theme and my theme quickly and without affecting font size.</p>

<p>With this in mind, I needed to export the default Visual Studio colors and the Vibrant Ink themes. To make switching themes short, I only exported Options > Environment > Fonts and Colors.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/fonts-and-colors.png" alt="fonts-and-colors" /></p>

<p>Next, I launched Tools > Macros > Macros IDE&hellip; and got to work. Using Jeff&rsquo;s macros as the base I started making my changes. So instead of loading settings for presentations, I made the macro toggle the font size between 10 and 15. When applying a change to the theme I made sure to remember the current font size and set it back after loading either the default theme or my own. Although I struggled a bit with the Visual Basic syntax, it wasn&rsquo;t long until I was finished.</p>

<p>Below is the modified <a href="https://github.com/JoeRobich/BlogCode/blob/master/Settings.vb">Settings macros</a> that I use.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Imports</span> <span class="nn">System</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">EnvDTE</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">EnvDTE80</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">EnvDTE90</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">EnvDTE90a</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">EnvDTE100</span>
</span><span class='line'><span class="k">Imports</span> <span class="nn">System.Diagnostics</span>
</span><span class='line'>
</span><span class='line'><span class="k">Public</span> <span class="k">Module</span> <span class="nn">Settings</span>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Const</span> <span class="n">FONT_SIZE_CATEGORY</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;FontsAndColors&quot;</span>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Const</span> <span class="n">FONT_SIZE_PAGE</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;TextEditor&quot;</span>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Const</span> <span class="n">FONT_SIZE_NAME</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;FontSize&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Private</span> <span class="n">RootFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;[Your Root]\Documents\Visual Studio 2010\Settings\&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ImportDefaultSettings</span><span class="p">()</span>
</span><span class='line'>        <span class="n">SetColorTheme</span><span class="p">(</span><span class="s">&quot;DefaultTheme&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ImportCodingSettings</span><span class="p">()</span>
</span><span class='line'>        <span class="n">SetColorTheme</span><span class="p">(</span><span class="s">&quot;VibrantInkTheme&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">TogglePresentationSettings</span><span class="p">()</span>
</span><span class='line'>        <span class="k">Dim</span> <span class="n">fontSizeProperty</span> <span class="ow">As</span> <span class="n">EnvDTE</span><span class="p">.</span><span class="n">Property</span> <span class="o">=</span> <span class="n">GetDTEProperty</span><span class="p">(</span><span class="n">FONT_SIZE_CATEGORY</span><span class="p">,</span> <span class="n">FONT_SIZE_PAGE</span><span class="p">,</span> <span class="n">FONT_SIZE_NAME</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">If</span> <span class="n">fontSizeProperty</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="mi">15</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">fontSizeProperty</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="mi">10</span>
</span><span class='line'>        <span class="k">Else</span>
</span><span class='line'>            <span class="n">fontSizeProperty</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="mi">15</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ImportKnRFormatting</span><span class="p">()</span>
</span><span class='line'>        <span class="n">ImportSettingsFile</span><span class="p">(</span><span class="s">&quot;KnRFormatting&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">DTE</span><span class="p">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s">&quot;Edit.FormatDocument&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ImportAllmanFormatting</span><span class="p">()</span>
</span><span class='line'>        <span class="n">ImportSettingsFile</span><span class="p">(</span><span class="s">&quot;AllmanFormatting&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">DTE</span><span class="p">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s">&quot;Edit.FormatDocument&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Sub</span> <span class="nf">SetColorTheme</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">fileName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>        <span class="k">Dim</span> <span class="n">fontSizeProperty</span> <span class="ow">As</span> <span class="n">EnvDTE</span><span class="p">.</span><span class="n">Property</span> <span class="o">=</span> <span class="n">GetDTEProperty</span><span class="p">(</span><span class="n">FONT_SIZE_CATEGORY</span><span class="p">,</span> <span class="n">FONT_SIZE_PAGE</span><span class="p">,</span> <span class="n">FONT_SIZE_NAME</span><span class="p">)</span>
</span><span class='line'>        <span class="k">Dim</span> <span class="n">fontSize</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">fontSizeProperty</span><span class="p">.</span><span class="n">Value</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">ImportSettingsFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">fontSizeProperty</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">fontSize</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">GetDTEProperty</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">categoryName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">pageName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">propertyName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">EnvDTE</span><span class="p">.</span><span class="n">Property</span>
</span><span class='line'>        <span class="k">For</span> <span class="k">Each</span> <span class="n">prop</span> <span class="ow">In</span> <span class="n">DTE</span><span class="p">.</span><span class="n">Properties</span><span class="p">(</span><span class="n">categoryName</span><span class="p">,</span> <span class="n">pageName</span><span class="p">)</span>
</span><span class='line'>            <span class="k">If</span> <span class="n">prop</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">propertyName</span> <span class="k">Then</span>
</span><span class='line'>                <span class="k">Return</span> <span class="n">prop</span>
</span><span class='line'>            <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>        <span class="k">Next</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Function</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Private</span> <span class="k">Sub</span> <span class="nf">ImportSettingsFile</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">FileName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>        <span class="n">FileName</span> <span class="o">=</span> <span class="n">IO</span><span class="p">.</span><span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">RootFolder</span><span class="p">,</span> <span class="n">FileName</span> <span class="o">&amp;</span> <span class="s">&quot;.vssettings&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">DTE</span><span class="p">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s">&quot;Tools.ImportandExportSettings&quot;</span><span class="p">,</span> <span class="s">&quot;-import:&quot;&quot;&quot;</span> <span class="o">&amp;</span> <span class="n">FileName</span> <span class="o">&amp;</span> <span class="s">&quot;&quot;&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">Sub</span>
</span><span class='line'>
</span><span class='line'><span class="k">End</span> <span class="k">Module</span>
</span></code></pre></td></tr></table></div></figure>


<p>At this point, I threw together a toolbar and added the macros to it. They worked! Now I wanted to create some nice icons to use just like Jeff had done. It was when I was trying to apply them that disappointment crept in. Despite the <a href="http://msdn.microsoft.com/en-us/library/3dy74ad1.aspx">documentation for adding macros</a> to a toolbar, the comments point out correctly that you cannot assign a macro command an image. Bummer.</p>

<p>Maybe I don&rsquo;t need a toolbar. I can just hook up the macros to some easy to remember shortcut chords. Click on Tools > Options&hellip; menu. Then browse to Environment > Keyboard. Type Macros.Settings into the filter box and we can start assigning.</p>

<p><img src="http://thedevstop.files.wordpress.com/2011/08/options-keyboard.png" alt="Keyboard Options" /></p>

<p>Finding shortcut keys that weren&rsquo;t already in use was a little frustrating, so I decided to go with &ldquo;long, but simple to remember&rdquo;. Using ctrl+alt+shift as the modifiers, my chords are s (for settings) then a, c, d, k, or p depending on which macro to launch.</p>

<p>Now I have no more excuses to use tiny code during my next presentation and if you follow these steps then neither will you. You can download my all of my vssettings, the macro file, and even the toolbar images I didn&rsquo;t get to use <a href="https://docs.google.com/viewer?a=v&amp;pid=explorer&amp;chrome=true&amp;srcid=0B2UumFXyeY3BYzkzMDliZjQtNjRiMC00NjdjLThhMzUtZTYxYWJiNjYyMTgx&amp;hl=en_US">here</a>.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/08/16/add-settings-hotkeys-to-visual-studio-2010/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SSWC and jQuery Image Rotator on CodePlex]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/02/15/sswc-and-jquery-image-rotator-on-codeplex/"/>
    <updated>2011-02-15T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/02/15/sswc-and-jquery-image-rotator-on-codeplex</id>
    <content type="html"><![CDATA[<p>Knowing that we had made a commitment and wanting our efforts to be utilized, we put in some extra hours to get an inital release together. <a href="http://twitter.com/jtolar">John Tolar</a> emailed us his Social Share Bar widget and some screenshots for inclusion in the project. However, there were a few issues we felt must be resolved before we could release the widgets to the world.</p>

<p>First, the <a href="http://www.sitefinity.com/devnet/forums/sitefinity-4-x/general-discussions/jquery-plugins-and-or-authoring-custom-jquery-functions-not-supported.aspx">jQuery plugin issue</a> we found on <a href="http://thedevstop.wordpress.com/2011/02/02/givecamp-day-3/">Day 3</a> of <a href="http://givecamp.org">GiveCamp</a>. It took a good bit of trial and error, but David came up with something a little less disgusting than what we had. RegisterScriptInclude had consistently loaded the script references too early in the page, and they were subject the Sitefinity issue linked above. Using the ClientScriptManager&rsquo;s RegisterStartupScript, however, pushed the script reference to the bottom of page and avoided the redefinition of jQuery. With our scripts now being included once a piece in a fairly sensible location, we closed this issue.</p>

<p>The other two issues were fairly trivial. First, we ensured that the generated HTML elements got unique ids. We had been generating facebookImageRotator, flickrImageRotator, etc., but if you threw two Facebook rotators on the page you&rsquo;d get a duplicate. We used the user ids, album names, etc. to make it a bit more unique. The last issue was having our widgets include <a href="http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/">prettyPhoto</a> automatically instead of relying on documentation to guide the user.</p>

<p>We polished up the documentation for Sitefinity developers interested in using the controls in their sites as well as those wanting to contribute to the project. David also started a separate CodePlex for hosting the fully independant <a href="http://jqueryimagerotator.codeplex.com">jQuery rotator plugin</a>.</p>

<p>Feel free to download the controls and please provide some feedback.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/02/15/sswc-and-jquery-image-rotator-on-codeplex/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GiveCamp Day 3]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/02/08/givecamp-day-3/"/>
    <updated>2011-02-08T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/02/08/givecamp-day-3</id>
    <content type="html"><![CDATA[<p>So you know how I was saying the rest of our team worked overnight? Yeah. David and I woke up to some huge news! It seems that it had been decided to switch to <a href="http://wordpress.org">WordPress</a>, although John reassured us that our efforts would not be in vain. He proposed packaging our widgets into an <a href="http://sswc.codeplex.com">open source contribution</a> to the <a href="http://sitefinity.com">Sitefinity</a> community. These widgets could be used in future <a href="http://givecamp.org">GiveCamp</a> projects to help many more charities, but first they would need some love. (First, we fueled up at IHOP with <a href="http://joshuarogers.net">Josh</a> and <a href="http://bryanprice.info">Bryan</a>. It was great to hang out a bit and share war stories, since we didn&rsquo;t get to do that much at the event itself.)</p>

<p>We decided that the rest of our day would be devoted to cleaning up code and writing documentation. We started by pulling out a lot of shared code into a helper class used by the rotator widgets. The next task was to refactor our inline JavaScript to be a jQuery plugin. We would invoke the imageRotator method on the containing element, passing in the image list and rotation interval.</p>

<p>Speaking of plugins, it was this that lead us to discover David&rsquo;s issue with <a href="http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/">prettyPhoto</a>. It seems that Sitefinity <a href="http://www.sitefinity.com/devnet/forums/sitefinity-4-x/general-discussions/jquery-plugins-and-or-authoring-custom-jquery-functions-not-supported.aspx">can trip you up</a> when loading your script references. Our temporary solution was to embed the script references in the widgets themselves. The obvious issue is that the generated HTML would have several duplicate references scattered throughout the body. We&rsquo;ll discuss a slightly more elegant solution in an upcoming post.</p>

<p>Our project also needed a home. We decided on using <a href="http://codeplex.com">CodePlex</a> to host the widgets. I created the <a href="http://sswc.codeplex.com">SSWC project</a> and started working on documentation. Time was short due to the upcoming wrap-up where the fruits of the weekend would be displayed.  We would have to put the finishing touches on our project another day. We&rsquo;ll discuss this in an upcoming post.</p>

<p>During the wrap-up, it was great to see how all the teams pulled together to produce effective solutions for these worthy organizations.</p>

<div class="embed-video-container"><iframe src="http://player.vimeo.com/video/19132894 "></iframe></div>


<p><a href="http://vimeo.com/19132894">Give Camp Birmingham | Promo</a> from <a href="http://vimeo.com/user445453">Hampton Road Studios</a> on <a href="http://vimeo.com">Vimeo</a>.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/02/08/givecamp-day-3/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GiveCamp Day 2]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/02/04/givecamp-day-2/"/>
    <updated>2011-02-04T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/02/04/givecamp-day-2</id>
    <content type="html"><![CDATA[<p>After a refreshing 6 hours of sleep, we met the following morning!</p>

<p>The first task we had before us was to implement a simple widget to learn the <a href="http://sitefinity.com">Sitefinity</a> APIs. For the sake of tradition, we implemented a &lsquo;Hello World&rsquo; widget which simply displayed a configurable message in a <span> tag. Using one of their included widgets as a starting point, it did not take long until we had our widget put together. John shot us a very helpful PDF that included the instructions to register the widget with our local Sitefinity instance, and we were off running!</p>

<p>Several of the widgets that we needed to implement were image rotating controls. The first of the Social Widgets to be implemented was a Facebook image rotator. Since we saw a lot of potential overlap, we worked on this widget together so that we could both have input on the pattern we&rsquo;d follow for the others.</p>

<p>The first step to implementing the Facebook widget was to pull a list of images from the Facebook API. We registered a Facebook application with Joy&rsquo;s account and added the application to the <a href="https://www.facebook.com/pages/Spirit-of-Hope-Youth-Ranch/66363425238">Spirit of Hope Youth Ranch on Facebook</a> page. After trying various FBML and FQL queries, we discovered the [Facebook C# SDK](<a href="http://facebooksdk.codeplex.com/">http://facebooksdk.codeplex.com/</a>]. After a little tweaking, we were able to pull in recent images from an account with an option to limit it to a specific album.</p>

<p>With this out of the way, we focused on implementing the image rotation. While David had been focusing on implementing the Facebook query, I had been writing a little jQuery in Notepad++. I shared this with David, and we soon had a working image rotator.</p>

<p>Mixing these two pieces together got us most of the functionality. All that remained was adding a lightbox when the image was clicked. A quick Google search later and we had decided that <a href="http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/">prettyPhoto</a> had the right mix of style and functionality.</p>

<p>Now that we had the first component mostly put together, I proceeded to implement a Flickr rotator while David incorporated the prettyPhoto plugin. I was much more successful than David (through no fault of his own &ndash; stay tuned for Day 3 to find out what happened!). I was able to reuse the query from another baked-in Flickr widget for pulling images from a user account. The most difficult part was determining the user id to use in the query. Luckily there is a <a href="http://idgettr.com/">handy site</a> for getting the user id from a Flickr user name.</p>

<p>With Dave seemingly at a dead end trying to get jQuery plugins working with Sitefinity, I proceeded to knockout the YouTube video rotator widget. By this point the host facility was shutting down, but the other members of our team had plans to work overnight. They were battling some layout issues getting Sitefinity to play nice with Brant&rsquo;s design. We felt we had a firm grasp on our task, so we headed home to get some much needed shut eye.</p>

<p>Also, I fell on some wickedly icy stairs, and David&rsquo;s car battery died. <a href="http://bryanprice.info">Bryan</a> and <a href="http://joshuarogers.net">Josh</a>, who were crashing at Dave&rsquo;s place, made a great rescue team. Thanks, guys!</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/02/04/givecamp-day-2/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GiveCamp Day 1]]></title>
    <link href="http://www.joeyrobichaud.com/blog/2011/02/01/givecamp-day-1/"/>
    <updated>2011-02-01T00:00:00-05:00</updated>
    <id>http://www.joeyrobichaud.com/blog/2011/02/01/givecamp-day-1</id>
    <content type="html"><![CDATA[<p>This was the first year that Birmingham hosted a satellite event for the national <a href="http://givecamp.org/">GiveCamp</a>. For those who don&rsquo;t know, GiveCamp is a event where developers and designers come together to donate their efforts to charity and non-profit organizations. Wanting to help the community and being located so close, we thought this was the perfect opportunity to share our skills.</p>

<p>The <a href="http://givecampbirmingham.org/">GiveCamp Birmingham</a> was organized by <a href="https://twitter.com/#!/LeverettPowell">Leverett Powell</a>, and three charities participated. <a href="http://sohyr.org">Spirit of Hope Youth Ranch</a> brings children with abused pasts together with abused horses. <a href="http://www.manta.com/c/mml1r6r/my-father-s-house-foundation-inc">My Father&rsquo;s House</a> takes in children who have outgrown foster care. Lastly, <a href="http://www.innovationdepot.net/">Innovation Depot</a> a non-profit business incubator.</p>

<p>Originally we had planned to form a team with a <a href="http://bryanprice.info">couple</a> of <a href="http://joshuarogers.net">coworkers</a> so that we could jam together. However, because of inclement weather the previous week, developer turnout was low and we had to split up. The charity we ended up working with was Spirit of Hope Youth Ranch.</p>

<p>The first night was used for team introductions and requirements gathering. Our team was rounded out by <a href="https://twitter.com/#!/jtolar/">John Tolar</a> who acted as Interim PM for the first night, <a href="http://www.google.com/profiles/litepack">Litepack on Google Profiles</a> as lead designer, and <a href="http://rebeccalynnmorrow.com/">Rebecca Lynn Morrow</a> as SEO Guru.</p>

<p>SOHYR was represented by Joy O&#8217;Neal. She did a great job expressing what she was looking for in the new website. We spent a good deal of time discussing the site map and social integration. Joy was very well prepared with images, videos and logos to use in the design.</p>

<p>John Tolar turned us on to <a href="http://www.sitefinity.com/">Sitefinity</a>, a product that was generously donated by <a href="http://telerik.com">Telerik</a> for all GiveCamp charities to use in their projects. Version 4.0 had just been released and John had experience building on previous versions of the platform. It showed strong layout and widgeting capabilities.</p>

<p>To round the social experience of the website, a list of missing widgets was compiled for development during the rest of the weekend. It was decided that David and I would focus on implementing these widgets. Brant would be in charge of the site layout and CSS while John would be responsible for applying that design to a Sitefinity instance. John would also contribute to the social widgets as time allowed. Rebecca would help Joy with rewording pages for SEO.</p>

<p>Everyone retired enthusiastically anticipating the work to come.</p>

<p><em>This post originally appeared on <a href="http://thedevstop.wordpress.com/2011/02/02/givecamp-day-1/">The DevStop</a>.</em></p>
]]></content>
  </entry>
  
</feed>
